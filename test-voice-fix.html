<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Selection Test - TUTOR.AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .test-result { padding: 10px; margin: 5px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
    </style>
</head>
<body class="bg-gray-100 p-4">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl font-bold mb-4">Voice Selection Test</h1>
        
        <div class="bg-white rounded-lg p-6 mb-4">
            <h2 class="text-lg font-semibold mb-4">Test Voice Selection</h2>
            
            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">Voice Selection:</label>
                <select id="voiceSelect" class="w-full p-2 border border-gray-300 rounded">
                    <option value="">Loading voices...</option>
                </select>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium mb-2">Teacher Selection:</label>
                <div class="flex gap-4">
                    <button onclick="selectTeacher('english')" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                        Roy Sir (English)
                    </button>
                    <button onclick="selectTeacher('hindi')" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
                        Ms. Sapana (Hindi)
                    </button>
                </div>
            </div>
            
            <div class="mb-4">
                <button onclick="testVoice()" class="px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600">
                    Test Current Voice
                </button>
            </div>
        </div>
        
        <div id="testResults" class="space-y-2">
            <div class="test-result info">Ready to test voice selection...</div>
        </div>
        
        <div class="mt-4">
            <button onclick="window.location.href='dashboard.html'" class="bg-green-500 text-white px-4 py-2 rounded">
                Go to Dashboard
            </button>
        </div>
    </div>

    <script>
        // Define teachers
        const teachers = {
            hindi: {
                name: "Ms. Sapana",
                image: "/public/images/teacher-avatar1.png"
            },
            english: {
                name: "Roy Sir",
                image: "/public/images/teacher-avatar2.png"
            }
        };

        let currentTeacher = teachers.english;

        function addTestResult(message, type = 'info') {
            const results = document.getElementById('testResults');
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.textContent = message;
            results.appendChild(div);
        }

        // Populate voice options with only specific voices
        function populateVoices() {
            const voiceSelect = document.getElementById('voiceSelect');
            if (!voiceSelect) return;
            
            const voices = speechSynthesis.getVoices();
            voiceSelect.innerHTML = '';
            
            // Define our preferred voices
            const preferredVoices = {
                english: 'Microsoft Ravi - English (India)',
                hindi: 'Google ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä'
            };
            
            // Find and add only our preferred voices
            voices.forEach((voice) => {
                if (voice.name === preferredVoices.english || voice.name === preferredVoices.hindi) {
                    const option = document.createElement('option');
                    option.value = voice.name;
                    option.textContent = voice.name;
                    option.setAttribute('data-language', voice.name === preferredVoices.english ? 'en' : 'hi');
                    voiceSelect.appendChild(option);
                }
            });
            
            // Set default voice based on current teacher
            if (currentTeacher === teachers.hindi) {
                const hindiVoice = voiceSelect.querySelector('[data-language="hi"]');
                if (hindiVoice) hindiVoice.selected = true;
            } else {
                const englishVoice = voiceSelect.querySelector('[data-language="en"]');
                if (englishVoice) englishVoice.selected = true;
            }
            
            addTestResult('‚úÖ Voices populated with preferred voices only', 'success');
        }

        // Update teacher and voice
        function selectTeacher(teacher) {
            if (teacher === 'hindi') {
                currentTeacher = teachers.hindi;
            } else {
                currentTeacher = teachers.english;
            }
            
            // Auto-update voice selection
            const voiceSelect = document.getElementById('voiceSelect');
            if (voiceSelect) {
                if (teacher === 'hindi') {
                    const hindiVoice = voiceSelect.querySelector('[data-language="hi"]');
                    if (hindiVoice) {
                        hindiVoice.selected = true;
                        addTestResult('‚úÖ Voice changed to Hindi: Google ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä', 'success');
                    }
                } else {
                    const englishVoice = voiceSelect.querySelector('[data-language="en"]');
                    if (englishVoice) {
                        englishVoice.selected = true;
                        addTestResult('‚úÖ Voice changed to English: Microsoft Ravi', 'success');
                    }
                }
            }
            
            addTestResult(`‚úÖ Teacher updated to: ${currentTeacher.name}`, 'success');
        }

        // Test current voice
        function testVoice() {
            const voiceSelect = document.getElementById('voiceSelect');
            if (!voiceSelect.value) {
                addTestResult('‚ùå No voice selected', 'error');
                return;
            }
            
            const voices = speechSynthesis.getVoices();
            const selectedVoice = voices.find(v => v.name === voiceSelect.value);
            
            if (selectedVoice) {
                const utterance = new SpeechSynthesisUtterance('Hello! This is a test of the voice selection.');
                utterance.voice = selectedVoice;
                utterance.rate = 0.9;
                
                utterance.onstart = () => {
                    addTestResult(`üé§ Speaking with: ${selectedVoice.name}`, 'info');
                };
                
                utterance.onend = () => {
                    addTestResult('‚úÖ Voice test completed', 'success');
                };
                
                speechSynthesis.speak(utterance);
            } else {
                addTestResult('‚ùå Selected voice not found', 'error');
            }
        }

        // Initialize
        window.addEventListener('load', () => {
            if (speechSynthesis) {
                speechSynthesis.onvoiceschanged = populateVoices;
                setTimeout(populateVoices, 500);
                addTestResult('‚úÖ Speech synthesis initialized', 'success');
            } else {
                addTestResult('‚ùå Speech synthesis not available', 'error');
            }
        });
    </script>
</body>
</html> 