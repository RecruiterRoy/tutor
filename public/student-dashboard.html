<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - tution.app</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Mobile responsive styles */
        @media (max-width: 1023px) {
            #sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 100;
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            
            #sidebar.sidebar-open {
                transform: translateX(0);
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
            }
            
            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 99;
            }
            
            .sidebar-overlay.active {
                display: block;
            }
        }
        
        /* Chat message styles */
        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            margin-bottom: 8px;
            line-height: 1.4;
        }
        
        .user-message {
            background-color: #3b82f6;
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        
        .ai-message {
            background-color: #f3f4f6;
            color: #374151;
            margin-right: auto;
            border-bottom-left-radius: 4px;
        }
        
        /* Loading animation */
        .typing-indicator {
            display: inline-block;
            position: relative;
            width: 60px;
            height: 20px;
        }
        
        .typing-indicator span {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #9ca3af;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-indicator span:nth-child(1) {
            left: 0;
            animation-delay: -0.32s;
        }
        
        .typing-indicator span:nth-child(2) {
            left: 16px;
            animation-delay: -0.16s;
        }
        
        .typing-indicator span:nth-child(3) {
            left: 32px;
        }
        
        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        /* Section transitions */
        .section {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .section.active {
            display: block;
            opacity: 1;
        }
        
        /* Navigation item styles */
        .nav-item {
            transition: all 0.2s ease;
        }
        
        .nav-item.active {
            background-color: #dbeafe;
            color: #1d4ed8;
        }
        
        /* Animation for celebration effects */
        @keyframes floatUp {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .celebration-item {
            position: fixed;
            z-index: 1000;
            pointer-events: none;
            animation: floatUp 5s ease-in-out forwards;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-white to-purple-50 min-h-screen">
    <!-- Mobile sidebar overlay -->
    <div id="sidebarOverlay" class="sidebar-overlay" onclick="toggleSidebar()"></div>
    
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div id="sidebar" class="bg-white/80 backdrop-blur-xl border-r border-gray-200 w-64 transform -translate-x-full transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 z-50">
            <div class="p-4">
                <div class="flex items-center justify-between mb-6">
                    <div class="flex items-center space-x-3">
                        <div class="h-8 w-8 bg-blue-500 rounded-lg flex items-center justify-center text-white font-bold">T</div>
                        <h1 class="text-xl font-bold text-gray-800">tution.app</h1>
                    </div>
                    <button id="closeSidebar" class="text-gray-600 text-2xl lg:hidden" onclick="toggleSidebar()">√ó</button>
                </div>
                
                <!-- User Info -->
                <div class="bg-blue-50 rounded-lg p-4 mb-6">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-lg" id="userAvatar">S</div>
                        <div>
                            <div class="text-gray-800 font-semibold" id="userName">Student Name</div>
                            <div class="text-gray-600 text-sm" id="userClass">Class 2 ‚Ä¢ CBSE</div>
                        </div>
                    </div>
                </div>
                
                <!-- Navigation -->
                <nav class="space-y-2">
                    <div class="nav-item active bg-blue-100 text-blue-700 px-4 py-3 rounded-lg cursor-pointer flex items-center space-x-3" onclick="showSection('classroomSection', this)">
                        <span class="text-2xl">üè´</span>
                        <span>Classroom</span>
                    </div>
                    <div class="nav-item text-gray-700 hover:bg-gray-100 px-4 py-3 rounded-lg cursor-pointer flex items-center space-x-3" onclick="showSection('homeworkSection', this)">
                        <span class="text-2xl">üìù</span>
                        <span>Homework</span>
                    </div>
                    <div class="nav-item text-gray-700 hover:bg-gray-100 px-4 py-3 rounded-lg cursor-pointer flex items-center space-x-3" onclick="showSection('assessmentSection', this)">
                        <span class="text-2xl">üìã</span>
                        <span>Assessment</span>
                    </div>
                    <div class="nav-item text-gray-700 hover:bg-gray-100 px-4 py-3 rounded-lg cursor-pointer flex items-center space-x-3" onclick="showSection('dailyChallengeSection', this)">
                        <span class="text-2xl">üéØ</span>
                        <span>Daily Quiz</span>
                        <span id="challengeStar" class="text-yellow-400 text-lg hidden">‚≠ê</span>
                    </div>
                    <div class="nav-item text-gray-700 hover:bg-gray-100 px-4 py-3 rounded-lg cursor-pointer flex items-center space-x-3" onclick="showSection('studyMaterialsSection', this)">
                        <span class="text-2xl">üìö</span>
                        <span>Study Materials</span>
                    </div>
                    <div class="nav-item text-gray-700 hover:bg-gray-100 px-4 py-3 rounded-lg cursor-pointer flex items-center space-x-3" onclick="showSection('profileSection', this)">
                        <span class="text-2xl">üë§</span>
                        <span>Profile</span>
                    </div>
                    <div class="nav-item text-gray-700 hover:bg-gray-100 px-4 py-3 rounded-lg cursor-pointer flex items-center space-x-3" onclick="showSection('settingsSection', this)">
                        <span class="text-2xl">‚öôÔ∏è</span>
                        <span>Settings</span>
                    </div>
                </nav>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col">
            <!-- Header -->
            <header class="bg-white/80 backdrop-blur-xl border-b border-gray-200 p-4">
                <div class="flex items-center justify-between">
                    <button id="mobileSidebarToggle" class="text-gray-600 text-2xl lg:hidden" onclick="toggleSidebar()">‚ò∞</button>
                    <div class="hidden lg:block">
                        <h2 class="text-xl font-semibold text-gray-800">Student Dashboard</h2>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="hidden md:flex items-center space-x-2 bg-blue-50 px-3 py-1 rounded-full">
                            <span class="text-blue-600">‚≠ê</span>
                            <span class="text-blue-800 font-medium" id="headerPoints">125</span>
                            <span class="text-blue-600">Points</span>
                        </div>
                        <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-sm" id="headerAvatar">S</div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 overflow-y-auto p-4">
                <!-- Classroom Section -->
                <div id="classroomSection" class="section active">
                    <div class="max-w-4xl mx-auto">
                        <!-- Chat Box -->
                        <div class="bg-white/90 backdrop-blur-xl rounded-2xl border border-gray-200 shadow-2xl h-[600px] flex flex-col">
                            <!-- Chat Header -->
                            <div class="p-4 border-b border-gray-200 flex-shrink-0">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-4">
                                        <img id="welcomeTeacherAvatar" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjQiIGN5PSIyNCIgcj0iMjQiIGZpbGw9IiM2QjdGRUEiLz4KPHN2ZyB4PSIxMiIgeT0iMTIiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ3aGl0ZSI+CjxwYXRoIGQ9Ik0xMiAxMmMyLjIxIDAgNC0xLjc5IDQtNCAwLTIuMjEtMS43OS00LTQtNC0yLjIxIDAtNCAxLjc5LTQgNCAwIDIuMjEgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYzAtMi42Ni01LjMzLTQtOC00eiIvPgo8L3N2Zz4KPC9zdmc+Cg==" alt="Teacher" class="w-12 h-12 rounded-full border-2 border-blue-300">
                                        <div>
                                            <div id="avatarName" class="text-gray-800 font-semibold">Roy Sir</div>
                                            <div class="text-gray-600 text-sm">Your AI Teacher</div>
                                        </div>
                                    </div>
                                    <div class="flex space-x-2">
                                        <button id="playButton" onclick="playTTS()" class="p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors" title="Play TTS">
                                            <span class="text-lg">‚ñ∂Ô∏è</span>
                                        </button>
                                        <button id="stopButton" onclick="stopTTS()" class="p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors" title="Stop TTS">
                                            <span class="text-lg">‚èπÔ∏è</span>
                                        </button>
                                        <button id="micButton" onclick="startMic()" class="p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors" title="Voice Input">
                                            <span class="text-sm font-medium">Mic</span>
                                        </button>
                                        <button id="ocrButton" onclick="startCameraScan()" class="p-2 bg-purple-100 text-purple-600 rounded-lg hover:bg-purple-200 transition-colors" title="Camera OCR">
                                            <span class="text-sm font-medium">Camera</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Chat Messages -->
                            <div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-4">
                                <div class="flex justify-start">
                                    <div class="message ai-message">
                                        Hello! I'm Roy Sir, your AI teacher. How can I help you with your studies today?
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Input Area -->
                            <div class="p-4 border-t border-gray-200 flex-shrink-0">
                                <div class="flex space-x-3">
                                    <input type="text" id="chatInput" placeholder="Ask me anything about your studies..." 
                                           class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500">
                                    <button id="cameraButton" onclick="startCameraScan()" class="px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                                        Camera
                                    </button>
                                    <button id="voiceButton" onclick="startMic()" class="px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                        Mic
                                    </button>
                                    <button id="sendButton" onclick="sendMessage()" class="px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                        Send
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Subject Selector -->
                        <div class="mt-4 bg-white/80 backdrop-blur-xl rounded-lg p-4 border border-gray-200">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-gray-800 font-semibold">Select Subject</span>
                                <button class="text-blue-600 hover:text-blue-800 text-sm">‚öôÔ∏è Manage</button>
                            </div>
                            <div class="flex flex-wrap gap-2">
                                <button class="px-4 py-2 bg-blue-100 text-blue-800 rounded-lg hover:bg-blue-200" onclick="selectSubject('General')">General</button>
                                <button class="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200" onclick="selectSubject('English')">English</button>
                                <button class="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200" onclick="selectSubject('Maths')">Maths</button>
                                <button class="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200" onclick="selectSubject('Hindi')">Hindi</button>
                                <button class="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200" onclick="selectSubject('EVS')">EVS</button>
                                <button class="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200" onclick="selectSubject('Science')">Science</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Homework Section -->
                <div id="homeworkSection" class="section">
                    <div class="max-w-4xl mx-auto">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">üìù Homework</h2>
                        <div class="bg-yellow-100 border border-yellow-300 rounded-lg p-6">
                            <div class="flex items-center space-x-3 mb-4">
                                <span class="text-2xl">‚ö†Ô∏è</span>
                                <h3 class="text-lg font-semibold text-gray-800">School Registration Required</h3>
                            </div>
                            <p class="text-gray-700">You will see your homework here once your school is registered with us.</p>
                        </div>
                    </div>
                </div>

                <!-- Assessment Section -->
                <div id="assessmentSection" class="section">
                    <div class="max-w-4xl mx-auto">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">üìã Assessment Center</h2>
                        
                        <!-- Quick Test -->
                        <div class="bg-white/80 rounded-lg p-6 mb-6 border border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üöÄ Quick Test</h3>
                            <p class="text-gray-600 mb-4">Generate a test quickly with preset options. Earn 5 points for taking the test!</p>
                            
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                                <select id="testSubject" class="px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                    <option value="">Select Subject</option>
                                    <option value="mathematics">Mathematics</option>
                                    <option value="science">Science</option>
                                    <option value="english">English</option>
                                    <option value="hindi">Hindi</option>
                                    <option value="evs">EVS</option>
                                    <option value="social_studies">Social Studies</option>
                                </select>
                                
                                <select id="testDuration" class="px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                    <option value="5">5 minutes</option>
                                    <option value="10">10 minutes</option>
                                    <option value="15">15 minutes</option>
                                    <option value="20">20 minutes</option>
                                    <option value="30">30 minutes</option>
                                </select>
                                
                                <select id="testDifficulty" class="px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                    <option value="easy">Easy</option>
                                    <option value="medium">Medium</option>
                                    <option value="hard">Hard</option>
                                </select>
                                
                                <button id="startQuickTest" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors font-medium">
                                    Start Test
                                </button>
                            </div>
                            
                            <div class="text-sm text-gray-600">
                                <span class="font-medium">Points:</span> 5 points for taking + 2 points per correct answer
                            </div>
                        </div>
                        
                        <!-- Custom Test -->
                        <div class="bg-white/80 rounded-lg p-6 mb-6 border border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üéØ Custom Test</h3>
                            <p class="text-gray-600 mb-4">Create a personalized test with specific topics and questions. Earn 5 points for taking + 2 points per correct answer!</p>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <input type="text" id="customTestTopic" placeholder="Enter topic (e.g., Algebra, Photosynthesis, Grammar)" 
                                       class="px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                       
                                <select id="customTestQuestions" class="px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                    <option value="5">5 Questions</option>
                                    <option value="10">10 Questions</option>
                                    <option value="15">15 Questions</option>
                                    <option value="20">20 Questions</option>
                                    <option value="25">25 Questions</option>
                                </select>
                                
                                <button id="createCustomTest" class="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors font-medium">
                                    Create Test
                                </button>
                            </div>
                            
                            <div class="text-sm text-gray-600">
                                <span class="font-medium">AI Generated:</span> Questions will be created based on your class syllabus and topic
                            </div>
                        </div>
                        
                        <!-- Test History -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üìä Recent Tests</h3>
                            <div id="testHistory" class="space-y-3">
                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <h4 class="text-gray-800 font-medium">Mathematics Quiz</h4>
                                            <p class="text-gray-600 text-sm">Completed 2 days ago</p>
                                        </div>
                                        <div class="text-right">
                                            <span class="text-green-600 font-bold">85%</span>
                                            <p class="text-gray-600 text-sm">17/20 ‚Ä¢ 39 points</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <h4 class="text-gray-800 font-medium">Science Test</h4>
                                            <p class="text-gray-600 text-sm">Completed 1 week ago</p>
                                        </div>
                                        <div class="text-right">
                                            <span class="text-yellow-600 font-bold">72%</span>
                                            <p class="text-gray-600 text-sm">18/25 ‚Ä¢ 41 points</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <h4 class="text-gray-800 font-medium">English Grammar</h4>
                                            <p class="text-gray-600 text-sm">Completed 2 weeks ago</p>
                                        </div>
                                        <div class="text-right">
                                            <span class="text-green-600 font-bold">90%</span>
                                            <p class="text-gray-600 text-sm">9/10 ‚Ä¢ 23 points</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Points Summary -->
                        <div class="bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg p-6 text-white">
                            <h3 class="text-lg font-semibold mb-2">üèÜ Your Points</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="text-center">
                                    <div class="text-2xl font-bold">103</div>
                                    <div class="text-blue-100">Total Points</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold">15</div>
                                    <div class="text-blue-100">Tests Taken</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold">78%</div>
                                    <div class="text-blue-100">Average Score</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Daily Challenge Section -->
                <div id="dailyChallengeSection" class="section">
                    <div class="max-w-4xl mx-auto">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">üéØ Daily Quiz</h2>
                        
                        <!-- Daily Quiz Status -->
                        <div class="bg-gradient-to-r from-purple-500 to-pink-600 rounded-lg p-6 text-white mb-6">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-semibold">Today's Challenge</h3>
                                    <p class="text-purple-100">New question available at 5:00 PM daily</p>
                                </div>
                                <div class="text-right">
                                    <div class="text-3xl font-bold" id="dailyStreak">5</div>
                                    <div class="text-purple-100">Day Streak</div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                                <div>
                                    <div class="text-2xl font-bold" id="quizPoints">42</div>
                                    <div class="text-purple-100">Quiz Points</div>
                                </div>
                                <div>
                                    <div class="text-2xl font-bold" id="totalPoints">125</div>
                                    <div class="text-purple-100">Total Points</div>
                                </div>
                                <div>
                                    <div class="text-2xl font-bold" id="rankPosition">15</div>
                                    <div class="text-purple-100">Your Rank</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Today's Question -->
                        <div id="todayQuestion" class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <div class="text-center">
                                <h3 class="text-lg font-semibold text-gray-800 mb-4">Today's Question</h3>
                                <div id="dailyQuestionContent" class="text-gray-700 mb-6">
                                    <p>What is the capital of India?</p>
                                </div>
                                <div id="dailyQuestionOptions" class="space-y-3 mb-6">
                                    <label class="flex items-center space-x-3 cursor-pointer p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                                        <input type="radio" name="dailyAnswer" value="0" class="text-blue-600">
                                        <span class="text-gray-700">Mumbai</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                                        <input type="radio" name="dailyAnswer" value="1" class="text-blue-600">
                                        <span class="text-gray-700">New Delhi</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                                        <input type="radio" name="dailyAnswer" value="2" class="text-blue-600">
                                        <span class="text-gray-700">Kolkata</span>
                                    </label>
                                    <label class="flex items-center space-x-3 cursor-pointer p-3 border border-gray-200 rounded-lg hover:bg-gray-50">
                                        <input type="radio" name="dailyAnswer" value="3" class="text-blue-600">
                                        <span class="text-gray-700">Chennai</span>
                                    </label>
                                </div>
                                <div class="flex justify-center space-x-4">
                                    <button id="submitDailyAnswer" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors font-medium">
                                        Submit Answer
                                    </button>
                                    <button id="skipQuestion" class="bg-gray-500 text-white px-4 py-3 rounded-lg hover:bg-gray-600 transition-colors">
                                        Skip
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Question History -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üìö Recent Questions</h3>
                            <div id="questionHistory" class="space-y-3">
                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <div class="flex justify-between items-start">
                                        <div class="flex-1">
                                            <div class="flex items-center space-x-2 mb-2">
                                                <span class="text-sm font-medium text-gray-600">Mathematics</span>
                                                <span class="text-xs px-2 py-1 rounded bg-green-100 text-green-800">Correct</span>
                                            </div>
                                            <div class="text-gray-800 text-sm mb-2">What is 15 + 27?</div>
                                            <div class="text-xs text-gray-500">2 days ago</div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-lg font-bold text-green-600">+10</div>
                                            <div class="text-xs text-gray-500">points</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <div class="flex justify-between items-start">
                                        <div class="flex-1">
                                            <div class="flex items-center space-x-2 mb-2">
                                                <span class="text-sm font-medium text-gray-600">Science</span>
                                                <span class="text-xs px-2 py-1 rounded bg-red-100 text-red-800">Wrong</span>
                                            </div>
                                            <div class="text-gray-800 text-sm mb-2">What is the chemical symbol for gold?</div>
                                            <div class="text-xs text-gray-500">3 days ago</div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-lg font-bold text-gray-400">0</div>
                                            <div class="text-xs text-gray-500">points</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Leaderboard -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üèÜ Leaderboard</h3>
                            <div class="flex space-x-4 mb-4">
                                <button id="showGlobalLeaderboard" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                    Global
                                </button>
                                <button id="showClassLeaderboard" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors">
                                    Class 2
                                </button>
                            </div>
                            <div id="leaderboardContent" class="space-y-3">
                                <div class="flex items-center justify-between p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border border-yellow-200">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-white font-bold text-sm">R</div>
                                        <div>
                                            <div class="font-medium text-gray-800">Rahul Sharma</div>
                                            <div class="text-sm text-gray-500">Class 2 ‚Ä¢ Mumbai</div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-lg font-bold text-yellow-600">210</div>
                                        <div class="text-xs text-gray-500">points</div>
                                    </div>
                                    <div class="w-8 h-8 bg-yellow-400 rounded-full flex items-center justify-center text-white font-bold text-sm">1</div>
                                </div>
                                <div class="flex items-center justify-between p-4 bg-gradient-to-r from-gray-50 to-blue-50 rounded-lg border border-gray-200">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-sm">P</div>
                                        <div>
                                            <div class="font-medium text-gray-800">Priya Patel</div>
                                            <div class="text-sm text-gray-500">Class 2 ‚Ä¢ Delhi</div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-lg font-bold text-blue-600">195</div>
                                        <div class="text-xs text-gray-500">points</div>
                                    </div>
                                    <div class="w-8 h-8 bg-blue-400 rounded-full flex items-center justify-center text-white font-bold text-sm">2</div>
                                </div>
                                <div class="flex items-center justify-between p-4 bg-gradient-to-r from-orange-50 to-red-50 rounded-lg border border-orange-200">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center text-white font-bold text-sm">A</div>
                                        <div>
                                            <div class="font-medium text-gray-800">Amit Kumar</div>
                                            <div class="text-sm text-gray-500">Class 2 ‚Ä¢ Bangalore</div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-lg font-bold text-orange-600">180</div>
                                        <div class="text-xs text-gray-500">points</div>
                                    </div>
                                    <div class="w-8 h-8 bg-orange-400 rounded-full flex items-center justify-center text-white font-bold text-sm">3</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Study Materials Section -->
                <div id="studyMaterialsSection" class="section">
                    <div class="max-w-4xl mx-auto">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">üìö Study Materials</h2>
                        
                        <!-- Books Section -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üìñ Books</h3>
                            <div class="text-center py-12">
                                <div class="text-6xl mb-4">üìö</div>
                                <h4 class="text-xl font-semibold text-gray-700 mb-2">Coming Soon!</h4>
                                <p class="text-gray-500">We're working on bringing you a comprehensive collection of textbooks and study materials.</p>
                            </div>
                        </div>
                        
                        <!-- Videos Section -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üé• Educational Videos</h3>
                            <div id="videosContainer" class="space-y-4">
                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <div class="flex items-start space-x-4">
                                        <div class="flex-shrink-0">
                                            <div class="w-16 h-12 bg-red-500 rounded flex items-center justify-center text-white text-sm font-bold">
                                                ‚ñ∂Ô∏è
                                            </div>
                                        </div>
                                        <div class="flex-1">
                                            <h4 class="font-semibold text-gray-800 mb-1">Introduction to Algebra</h4>
                                            <p class="text-sm text-gray-600 mb-2">Mathematics ‚Ä¢ Class 2</p>
                                            <p class="text-sm text-gray-500 mb-3">Learn the basics of algebraic expressions and equations</p>
                                            <button class="inline-flex items-center px-3 py-2 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors">
                                                Watch Video
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                                    <div class="flex items-start space-x-4">
                                        <div class="flex-shrink-0">
                                            <div class="w-16 h-12 bg-blue-500 rounded flex items-center justify-center text-white text-sm font-bold">
                                                ‚ñ∂Ô∏è
                                            </div>
                                        </div>
                                        <div class="flex-1">
                                            <h4 class="font-semibold text-gray-800 mb-1">The Solar System</h4>
                                            <p class="text-sm text-gray-600 mb-2">Science ‚Ä¢ Class 2</p>
                                            <p class="text-sm text-gray-500 mb-3">Explore the planets and other celestial bodies in our solar system</p>
                                            <button class="inline-flex items-center px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors">
                                                Watch Video
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Profile Section -->
                <div id="profileSection" class="section">
                    <div class="max-w-4xl mx-auto">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">üë§ Profile</h2>
                            <button onclick="refreshProfileData()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center space-x-2">
                                <span>üîÑ</span>
                                <span>Refresh Data</span>
                            </button>
                        </div>
                        
                        <!-- Profile Header -->
                        <div class="bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg p-6 text-white mb-6">
                            <div class="flex items-center space-x-4">
                                <div class="w-20 h-20 bg-white/20 rounded-full flex items-center justify-center text-white font-bold text-3xl" id="profileAvatar">
                                    S
                                </div>
                                <div>
                                    <h3 class="text-2xl font-bold" id="profileName">Student Name</h3>
                                    <p class="text-blue-100" id="profileClassDisplay">Class 2 ‚Ä¢ CBSE</p>
                                    <p class="text-blue-100 text-sm" id="profileSchoolDisplay">School Name</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Personal Information -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üë§ Personal Information</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Full Name *</label>
                                    <input type="text" id="profileFullName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white" value="Student Name">
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Date of Birth</label>
                                    <input type="date" id="profileDOB" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white" value="2016-05-15">
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Gender</label>
                                    <select id="profileGender" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                        <option value="">Select Gender</option>
                                        <option value="male" selected>Male</option>
                                        <option value="female">Female</option>
                                        <option value="other">Other</option>
                                        <option value="prefer_not_to_say">Prefer not to say</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">City</label>
                                    <input type="text" id="profileCity" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white" value="Mumbai">
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Email Address</label>
                                    <input type="email" id="profileEmail" class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed" value="student@example.com" readonly>
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Mobile Number</label>
                                    <input type="tel" id="profilePhone" class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed" value="+91 9876543210" readonly>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Academic Information -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üìö Academic Information</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Class *</label>
                                    <select id="profileClass" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                        <option value="">Select Class</option>
                                        <option value="1">Class 1</option>
                                        <option value="2" selected>Class 2</option>
                                        <option value="3">Class 3</option>
                                        <option value="4">Class 4</option>
                                        <option value="5">Class 5</option>
                                        <option value="6">Class 6</option>
                                        <option value="7">Class 7</option>
                                        <option value="8">Class 8</option>
                                        <option value="9">Class 9</option>
                                        <option value="10">Class 10</option>
                                        <option value="11">Class 11</option>
                                        <option value="12">Class 12</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Board</label>
                                    <select id="profileBoard" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                        <option value="">Select Board</option>
                                        <option value="CBSE" selected>CBSE</option>
                                        <option value="ICSE">ICSE</option>
                                        <option value="State Board">State Board</option>
                                        <option value="International">International</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">School Name</label>
                                    <input type="text" id="profileSchool" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white" value="School Name">
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Roll Number</label>
                                    <input type="text" id="profileRollNo" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white" value="2023-24-012">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Subjects -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üìñ Subjects</h3>
                            <div class="mb-4">
                                <label class="block text-gray-700 font-medium mb-2">Select Your Subjects</label>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3" id="subjectsContainer">
                                    <div class="flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                        <span class="text-gray-700 font-medium">Mathematics</span>
                                        <button onclick="removeSubject('Mathematics')" class="text-red-500 hover:text-red-700 text-lg">
                                            √ó
                                        </button>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                        <span class="text-gray-700 font-medium">Science</span>
                                        <button onclick="removeSubject('Science')" class="text-red-500 hover:text-red-700 text-lg">
                                            √ó
                                        </button>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                        <span class="text-gray-700 font-medium">English</span>
                                        <button onclick="removeSubject('English')" class="text-red-500 hover:text-red-700 text-lg">
                                            √ó
                                        </button>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                        <span class="text-gray-700 font-medium">Hindi</span>
                                        <button onclick="removeSubject('Hindi')" class="text-red-500 hover:text-red-700 text-lg">
                                            √ó
                                        </button>
                                    </div>
                                    <div class="flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg">
                                        <span class="text-gray-700 font-medium">EVS</span>
                                        <button onclick="removeSubject('EVS')" class="text-red-500 hover:text-red-700 text-lg">
                                            √ó
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <input type="text" id="newSubject" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white" placeholder="Add custom subject">
                                <button id="addSubjectBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                    Add
                                </button>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200">
                            <div class="flex flex-col sm:flex-row gap-4">
                                <button id="saveProfileBtn" class="flex-1 bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors font-medium">
                                    üíæ Save Changes
                                </button>
                                <button id="resetProfileBtn" class="flex-1 bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors font-medium">
                                    üîÑ Reset to Default
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Section -->
                <div id="settingsSection" class="section">
                    <div class="max-w-4xl mx-auto">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">‚öôÔ∏è Settings</h2>
                        
                        <!-- Teacher Avatar Selection -->
                        <div class="bg-white/90 backdrop-blur-xl rounded-2xl border border-gray-200 shadow-2xl p-6 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üë®‚Äçüè´ Teacher Avatar Selection</h3>
                            <p class="text-gray-600 mb-6">Choose your AI teacher's personality and teaching style</p>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <!-- Roy Sir -->
                                <div class="avatar-option cursor-pointer p-6 border-2 border-blue-500 bg-blue-50 rounded-xl text-center" data-avatar="roy_sir" onclick="selectTeacher('roy_sir')">
                                    <div class="w-20 h-20 bg-blue-300 rounded-full mx-auto mb-4 flex items-center justify-center text-blue-800 font-bold text-lg">R</div>
                                    <div class="text-lg font-semibold text-gray-800 mb-2">Roy Sir</div>
                                    <div class="text-sm text-gray-600 mb-3">Mathematics & Science Expert</div>
                                    <div class="text-xs text-gray-500 space-y-1">
                                        <div>üéØ Focused on problem-solving</div>
                                        <div>üìä Data-driven explanations</div>
                                        <div>üî¨ Science & Technology</div>
                                        <div>üíº Professional & Structured</div>
                                    </div>
                                    <div class="mt-4 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg text-sm font-medium">
                                        English & Advanced Topics
                                    </div>
                                </div>
                                
                                <!-- Miss Sapna -->
                                <div class="avatar-option cursor-pointer p-6 border-2 border-gray-200 rounded-xl text-center hover:border-pink-500 transition-all duration-300 hover:shadow-lg" data-avatar="miss_sapna" onclick="selectTeacher('miss_sapna')">
                                    <div class="w-20 h-20 bg-pink-300 rounded-full mx-auto mb-4 flex items-center justify-center text-pink-800 font-bold text-lg">S</div>
                                    <div class="text-lg font-semibold text-gray-800 mb-2">Miss Sapna</div>
                                    <div class="text-sm text-gray-600 mb-3">Language & Arts Specialist</div>
                                    <div class="text-xs text-gray-500 space-y-1">
                                        <div>üíù Warm & Encouraging</div>
                                        <div>üìö Story-based learning</div>
                                        <div>üé® Creative & Interactive</div>
                                        <div>üåç Cultural & Social</div>
                                    </div>
                                    <div class="mt-4 px-4 py-2 bg-pink-100 text-pink-700 rounded-lg text-sm font-medium">
                                        Hindi, English & Hinglish
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Current Selection Indicator -->
                            <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                                <div class="flex items-center space-x-3">
                                    <span class="text-blue-600">‚úÖ</span>
                                    <span class="text-gray-700">Currently selected: </span>
                                    <span id="currentTeacherName" class="font-semibold text-blue-700">Roy Sir</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Notification Preferences -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üîî Notification Preferences</h3>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-700">Daily Quiz Reminders</div>
                                        <div class="text-sm text-gray-500">Get notified when new daily questions are available</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="dailyQuizNotifications" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-700">Assessment Results</div>
                                        <div class="text-sm text-gray-500">Get notified when your test results are ready</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="assessmentNotifications" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-700">Study Reminders</div>
                                        <div class="text-sm text-gray-500">Get gentle reminders to study regularly</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="studyReminders" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-700">Email Notifications</div>
                                        <div class="text-sm text-gray-500">Receive important updates via email</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="emailNotifications" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Appearance Settings -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üé® Appearance</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Theme</label>
                                    <select id="themeSelector" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                        <option value="light" selected>Light Theme (Default)</option>
                                        <option value="dark">Dark Theme</option>
                                        <option value="auto">Auto (System)</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Font Size</label>
                                    <select id="fontSizeSelector" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 bg-white">
                                        <option value="small">Small</option>
                                        <option value="medium" selected>Medium (Default)</option>
                                        <option value="large">Large</option>
                                        <option value="extra-large">Extra Large</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 font-medium mb-2">Color Scheme</label>
                                    <div class="grid grid-cols-3 gap-3">
                                        <div class="color-option cursor-pointer p-3 border-2 border-blue-500 bg-blue-50 rounded-lg text-center" data-color="blue">
                                            <div class="w-8 h-8 bg-blue-500 rounded mx-auto mb-2"></div>
                                            <div class="text-xs text-gray-700">Blue</div>
                                        </div>
                                        <div class="color-option cursor-pointer p-3 border-2 border-gray-200 rounded-lg text-center hover:border-blue-500 transition-colors" data-color="purple">
                                            <div class="w-8 h-8 bg-purple-500 rounded mx-auto mb-2"></div>
                                            <div class="text-xs text-gray-700">Purple</div>
                                        </div>
                                        <div class="color-option cursor-pointer p-3 border-2 border-gray-200 rounded-lg text-center hover:border-blue-500 transition-colors" data-color="green">
                                            <div class="w-8 h-8 bg-green-500 rounded mx-auto mb-2"></div>
                                            <div class="text-xs text-gray-700">Green</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Privacy Settings -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üîí Privacy & Security</h3>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-700">Profile Visibility</div>
                                        <div class="text-sm text-gray-500">Allow other students to see your profile</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="profileVisibility" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-700">Leaderboard Visibility</div>
                                        <div class="text-sm text-gray-500">Show your name on leaderboards</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="leaderboardVisibility" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-700">Data Collection</div>
                                        <div class="text-sm text-gray-500">Allow us to collect usage data for improvement</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="dataCollection" class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <div class="font-medium text-gray-700">Auto-logout</div>
                                        <div class="text-sm text-gray-500">Automatically log out after inactivity</div>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="autoLogout" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Account Actions -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">üë§ Account Actions</h3>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200">
                                    <div>
                                        <div class="font-medium text-gray-700">Export Data</div>
                                        <div class="text-sm text-gray-500">Download your learning data and progress</div>
                                    </div>
                                    <button id="exportDataBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                        Export
                                    </button>
                                </div>
                                
                                <div class="flex items-center justify-between p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                                    <div>
                                        <div class="font-medium text-gray-700">Reset Progress</div>
                                        <div class="text-sm text-gray-500">Clear all your quiz scores and assessment history</div>
                                    </div>
                                    <button id="resetProgressBtn" class="px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors">
                                        Reset
                                    </button>
                                </div>
                                
                                <div class="flex items-center justify-between p-4 bg-red-50 rounded-lg border border-red-200">
                                    <div>
                                        <div class="font-medium text-gray-700">Delete Account</div>
                                        <div class="text-sm text-gray-500">Permanently delete your account and all data</div>
                                    </div>
                                    <button id="deleteAccountBtn" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Save Settings -->
                        <div class="bg-white/80 rounded-lg p-6 border border-gray-200">
                            <div class="flex flex-col sm:flex-row gap-4">
                                <button id="saveSettingsBtn" class="flex-1 bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors font-medium">
                                    üíæ Save Settings
                                </button>
                                <button id="resetSettingsBtn" class="flex-1 bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors font-medium">
                                    üîÑ Reset to Default
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let currentSection = 'classroomSection';
        let currentSubject = 'General';
        let currentTeacher = 'roy_sir';
        let gptService = null;
        let enhancedAI = null;
        let recognition = null;
        let cameraStream = null;
        let speechSynthesis = window.speechSynthesis;
        let currentUtterance = null;
        
        // User points and data
        const userData = {
            points: 125,
            streak: 5,
            rank: 15,
            quizPoints: 42,
            testsTaken: 15,
            averageScore: 78
        };

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing Student Dashboard...');
            initializeDashboard();
        });

        // Initialize dashboard components
        function initializeDashboard() {
            // Setup mobile sidebar
            setupMobileSidebar();
            
            // Load user data
            loadUserData();
            
            // Initialize AI services
            initializeAIServices();
            
            // Initialize components
            initializeChat();
            initializeDailyQuiz();
            initializeAssessment();
            initializeStudyMaterials();
            initializeHomework();
            initializeProfile();
            initializeSettings();
            
            console.log('‚úÖ Dashboard initialized successfully');
            
            // Show welcome message
            setTimeout(() => {
                showWelcomeMessage();
            }, 500);
        }

        // Setup mobile sidebar functionality
        function setupMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            // Close sidebar when clicking on overlay
            if (overlay) {
                overlay.addEventListener('click', toggleSidebar);
            }
            
            // Close sidebar button
            const closeButton = document.getElementById('closeSidebar');
            if (closeButton) {
                closeButton.addEventListener('click', toggleSidebar);
            }
        }

        // Toggle sidebar on mobile
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            if (sidebar && overlay) {
                sidebar.classList.toggle('sidebar-open');
                overlay.classList.toggle('active');
                
                // Prevent body scrolling when sidebar is open
                if (sidebar.classList.contains('sidebar-open')) {
                    document.body.style.overflow = 'hidden';
                } else {
                    document.body.style.overflow = 'auto';
                }
            }
        }

        // Initialize AI services
        function initializeAIServices() {
            try {
                // Initialize GPT Service
                if (typeof GPTService !== 'undefined') {
                    gptService = new GPTService();
                    console.log('‚úÖ GPT Service initialized');
                    
                    // Set up event hooks
                    gptService.onMessageSent = (message) => {
                        console.log('üì§ Message sent:', message);
                    };
                    
                    gptService.onMessageReceived = (message) => {
                        console.log('üì• Message received:', message);
                        addAIMessageToChat(message);
                    };
                    
                    gptService.onError = (error) => {
                        console.error('‚ùå GPT Service Error:', error);
                        addAIMessageToChat("I'm having trouble connecting right now. Please try again later.");
                    };
                } else {
                    console.warn('‚ö†Ô∏è GPT Service not available');
                }
                
                // Initialize Enhanced AI Service
                if (typeof EnhancedAIService !== 'undefined') {
                    enhancedAI = new EnhancedAIService();
                    console.log('‚úÖ Enhanced AI Service initialized');
                } else {
                    console.warn('‚ö†Ô∏è Enhanced AI Service not available');
                }
            } catch (error) {
                console.error('‚ùå Error initializing AI services:', error);
            }
        }

        // Initialize chat functionality
        function initializeChat() {
            console.log('üí¨ Initializing chat...');
            
            const sendButton = document.getElementById('sendButton');
            const chatInput = document.getElementById('chatInput');
            
            if (sendButton && chatInput) {
                sendButton.addEventListener('click', sendMessage);
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }
        }

        // Send message function
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to chat
            addUserMessageToChat(message);
            input.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                // Use GPT Service if available
                if (gptService) {
                    // Set context if available
                    if (currentUser && currentUser.class) {
                        gptService.setContext(currentUser.class, currentSubject);
                    }
                    
                    // Send message
                    await gptService.sendMessage(message, currentUser);
                } else {
                    // Fallback to direct API call
                    const response = await fetch('/api/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            message: message,
                            grade: currentUser?.class || '2',
                            subject: currentSubject,
                            language: 'en',
                            userProfile: currentUser
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        addAIMessageToChat(data.reply || data.response || 'I understand your question. Let me help you with that.');
                    } else {
                        throw new Error('API request failed');
                    }
                }
            } catch (error) {
                console.error('‚ùå Error sending message:', error);
                addAIMessageToChat("I'm having trouble connecting right now. Please try again later.");
            } finally {
                // Remove typing indicator
                removeTypingIndicator();
            }
        }

        // Add user message to chat
        function addUserMessageToChat(message) {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex justify-end';
            
            const messageBubble = document.createElement('div');
            messageBubble.className = 'message user-message';
            messageBubble.textContent = message;
            
            messageDiv.appendChild(messageBubble);
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Add AI message to chat
        function addAIMessageToChat(message) {
            const chatMessages = document.getElementById('chatMessages');
            if (!chatMessages) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex justify-start';
            
            const messageBubble = document.createElement('div');
            messageBubble.className = 'message ai-message';
            messageBubble.innerHTML = message;
            
            messageDiv.appendChild(messageBubble);
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Show typing indicator
        function showTypingIndicator() {        const chatMessages = document.getElementById('chatMessages');
        if (!chatMessages) return;
        
        const indicatorDiv = document.createElement('div');
        indicatorDiv.className = 'flex justify-start';
        indicatorDiv.id = 'typingIndicator';
        
        const indicatorBubble = document.createElement('div');
        indicatorBubble.className = 'message ai-message';
        
        const typingIndicator = document.createElement('div');
        typingIndicator.className = 'typing-indicator';
        typingIndicator.innerHTML = '<span></span><span></span><span></span>';
        
        indicatorBubble.appendChild(typingIndicator);
        indicatorDiv.appendChild(indicatorBubble);
        chatMessages.appendChild(indicatorDiv);
        
        // Scroll to bottom
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    // Remove typing indicator
    function removeTypingIndicator() {
        const indicator = document.getElementById('typingIndicator');
        if (indicator) {
            indicator.remove();
        }
    }

    // Show welcome message
    function showWelcomeMessage() {
        const welcomeMessage = `Hello ${currentUser?.name || 'Student'}! Welcome to your personalized learning dashboard. I'm here to help you with your studies. How can I assist you today?`;
        
        // This is already in the initial chat, so we don't need to add it again
        // But we could use this function for other welcome messages
    }

    // TTS (Text-to-Speech) functionality
    function speakText(text, teacher = 'Roy Sir') {
        if (!speechSynthesis) {
            console.warn('‚ö†Ô∏è Speech synthesis not supported');
            return;
        }

        // Stop any current speech
        if (currentUtterance) {
            speechSynthesis.cancel();
        }

        // Create new utterance
        currentUtterance = new SpeechSynthesisUtterance(text);
        
        // Set voice properties
        currentUtterance.rate = 0.9;
        currentUtterance.pitch = 1.0;
        currentUtterance.volume = 1.0;

        // Event handlers
        currentUtterance.onstart = () => console.log('üîä TTS started');
        currentUtterance.onend = () => console.log('üîä TTS ended');
        currentUtterance.onerror = (event) => {
            console.error('‚ùå TTS error:', event);
        };

        // Speak
        speechSynthesis.speak(currentUtterance);
    }

    function stopSpeech() {
        if (speechSynthesis && currentUtterance) {
            speechSynthesis.cancel();
            currentUtterance = null;
            console.log('üîá Speech stopped');
        }
    }

    function playTTS() {
        // Replay the last AI message
        const lastMessage = document.querySelector('#chatMessages .ai-message:last-child');
        if (lastMessage) {
            const messageText = lastMessage.textContent;
            speakText(messageText, 'Roy Sir');
        } else {
            speakText('Hello! How can I help you today?', 'Roy Sir');
        }
    }

    function stopTTS() {
        stopSpeech();
    }

    // Mic (Speech-to-Text) functionality
    function startMic() {
        try {
            console.log('üé§ Starting microphone...');
            
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Speech recognition not supported in this browser.');
                return;
            }
            
            // Initialize speech recognition
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';
            
            recognition.onstart = () => {
                console.log('üé§ Microphone started');
                // Update UI to show mic is active
                const micButtons = document.querySelectorAll('#micButton, #voiceButton');
                micButtons.forEach(button => {
                    button.classList.add('bg-red-500', 'text-white');
                    button.classList.remove('bg-blue-100', 'bg-green-600');
                    button.textContent = 'Listening...';
                });
            };
            
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                console.log('üé§ Speech recognized:', transcript);
                
                // Add to chat input
                const chatInput = document.getElementById('chatInput');
                if (chatInput) {
                    chatInput.value = transcript;
                }
                
                // Stop mic
                stopMic();
            };
            
            recognition.onerror = (event) => {
                console.error('‚ùå Speech recognition error:', event.error);
                stopMic();
            };
            
            recognition.onend = () => {
                console.log('üé§ Microphone stopped');
                stopMic();
            };
            
            recognition.start();
            
        } catch (error) {
            console.error('‚ùå Error starting microphone:', error);
            alert('Could not start microphone. Please check permissions.');
        }
    }
    
    function stopMic() {
        if (recognition) {
            recognition.stop();
            recognition = null;
        }
        
        // Update UI
        const micButtons = document.querySelectorAll('#micButton, #voiceButton');
        micButtons.forEach(button => {
            button.classList.remove('bg-red-500', 'text-white');
            if (button.id === 'micButton') {
                button.classList.add('bg-blue-100', 'text-blue-600');
                button.textContent = 'Mic';
            } else {
                button.classList.add('bg-green-600', 'text-white');
                button.textContent = 'Mic';
            }
        });
        
        console.log('üîá Microphone stopped');
    }

    // Camera and OCR functionality
    async function startCameraScan() {
        try {
            console.log('üì∑ Starting camera scan...');
            
            // Check if camera is already active
            if (cameraStream) {
                stopCamera();
                return;
            }

            // Create camera modal
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.id = 'cameraModal';
            
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-2xl w-full p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-gray-800">Camera Scanner</h3>
                        <button onclick="closeCameraModal()" class="text-gray-500 hover:text-gray-700 text-2xl">√ó</button>
                    </div>
                    
                    <div class="mb-4">
                        <video id="cameraVideo" autoplay playsinline class="w-full h-64 bg-gray-100 rounded-lg"></video>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button onclick="captureImage()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                            üì∏ Capture & Scan
                        </button>
                        <button onclick="stopCamera()" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600">
                            Stop Camera
                        </button>
                    </div>
                    
                    <div id="ocrResult" class="mt-4 p-3 bg-gray-50 rounded-lg hidden">
                        <h4 class="font-semibold text-gray-800 mb-2">OCR Result:</h4>
                        <div id="ocrText" class="text-gray-700"></div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Start camera
            await startCamera();
            
        } catch (error) {
            console.error('‚ùå Error starting camera:', error);
            alert('Could not access camera. Please check permissions.');
        }
    }

    async function startCamera() {
        try {
            cameraStream = await navigator.mediaDevices.getUserMedia({ 
                video: { 
                    facingMode: 'environment',
                    width: { ideal: 1280 },
                    height: { ideal: 720 }
                } 
            });
            
            const cameraVideo = document.getElementById('cameraVideo');
            if (cameraVideo) {
                cameraVideo.srcObject = cameraStream;
            }
            
            console.log('‚úÖ Camera started successfully');
            
        } catch (error) {
            console.error('‚ùå Camera access error:', error);
            
            // Fallback to file input
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    processImageFile(file);
                }
            };
            input.click();
        }
    }

    function stopCamera() {
        if (cameraStream) {
            cameraStream.getTracks().forEach(track => track.stop());
            cameraStream = null;
        }
        
        const cameraVideo = document.getElementById('cameraVideo');
        if (cameraVideo) {
            cameraVideo.srcObject = null;
        }
        
        console.log('üîá Camera stopped');
    }

    function closeCameraModal() {
        stopCamera();
        const modal = document.getElementById('cameraModal');
        if (modal) {
            modal.remove();
        }
    }

    async function captureImage() {
        const cameraVideo = document.getElementById('cameraVideo');
        if (!cameraVideo) return;
        
        try {
            // Create canvas to capture image
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            
            canvas.width = cameraVideo.videoWidth;
            canvas.height = cameraVideo.videoHeight;
            
            context.drawImage(cameraVideo, 0, 0);
            
            // Convert to blob
            canvas.toBlob(async (blob) => {
                if (blob) {
                    await processImageFile(blob);
                }
            }, 'image/jpeg', 0.8);
            
        } catch (error) {
            console.error('‚ùå Error capturing image:', error);
        }
    }

    async function processImageFile(file) {
        try {
            console.log('üîç Processing image for OCR...');
            
            // Show loading
            const ocrResult = document.getElementById('ocrResult');
            const ocrText = document.getElementById('ocrText');
            
            if (ocrResult && ocrText) {
                ocrResult.classList.remove('hidden');
                ocrText.textContent = 'Processing image...';
            }
            
            // Create FormData for upload
            const formData = new FormData();
            formData.append('image', file);
            
            // Send to OCR API
            const response = await fetch('/api/ocr', {
                method: 'POST',
                body: formData
            });
            
            if (response.ok) {
                const data = await response.json();
                
                if (data.success && data.text) {
                    const extractedText = data.text;
                    
                    // Display OCR result
                    if (ocrText) {
                        ocrText.textContent = extractedText;
                    }
                    
                    // Add to chat
                    addAIMessageToChat(`I can see the following text in your image:\n\n"${extractedText}"\n\nHow can I help you with this?`);
                    
                    // Close camera modal
                    closeCameraModal();
                    
                } else {
                    if (ocrText) {
                        ocrText.textContent = 'No text found in image.';
                    }
                }
            } else {
                if (ocrText) {
                    ocrText.textContent = 'Error processing image.';
                }
            }
            
        } catch (error) {
            console.error('‚ùå OCR processing error:', error);
            const ocrText = document.getElementById('ocrText');
            if (ocrText) {
                ocrText.textContent = 'Error processing image.';
            }
        }
    }

    // Select subject function
    function selectSubject(subject) {
        currentSubject = subject;
        console.log(`üìö Subject selected: ${subject}`);
        
        // Update UI to show selected subject
        const buttons = document.querySelectorAll('.bg-blue-100, .bg-gray-100');
        buttons.forEach(button => {
            button.classList.remove('bg-blue-100', 'text-blue-800');
            button.classList.add('bg-gray-100', 'text-gray-800');
        });
        
        // Find and highlight the selected button
        const buttonsArray = Array.from(buttons);
        const selectedButton = buttonsArray.find(button => button.textContent.includes(subject));
        if (selectedButton) {
            selectedButton.classList.remove('bg-gray-100', 'text-gray-800');
            selectedButton.classList.add('bg-blue-100', 'text-blue-800');
        }
        
        // Update GPT service context
        if (gptService && currentUser) {
            gptService.setContext(currentUser.class, subject);
        }
    }

    // Show section function
    function showSection(sectionName, element) {
        console.log('üîß Showing section:', sectionName);
        
        // Hide all sections
        const allSections = document.querySelectorAll('.section');
        allSections.forEach(section => {
            section.classList.remove('active');
        });
        
        // Remove active class from all nav items
        const allNavItems = document.querySelectorAll('.nav-item');
        allNavItems.forEach(item => {
            item.classList.remove('active', 'bg-blue-100', 'text-blue-700');
            item.classList.add('text-gray-700', 'hover:bg-gray-100');
        });
        
        // Show target section
        const targetSection = document.getElementById(sectionName);
        if (targetSection) {
            targetSection.classList.add('active');
            currentSection = sectionName;
            
            // Add active class to clicked nav item
            if (element) {
                element.classList.remove('text-gray-700', 'hover:bg-gray-100');
                element.classList.add('active', 'bg-blue-100', 'text-blue-700');
            }
            
            // Close sidebar on mobile after selection
            if (window.innerWidth < 1024) {
                toggleSidebar();
            }
        }
    }

    // Load user data
    function loadUserData() {
        console.log('üë§ Loading user data...');
        
        // Simulated user data - replace with actual data loading
        currentUser = {
            name: 'Student Name',
            email: 'student@example.com',
            class: '2',
            board: 'CBSE',
            school: 'School Name',
            city: 'Mumbai',
            phone: '+91 9876543210',
            dob: '2016-05-15',
            gender: 'male',
            rollNo: '2023-24-012'
        };
        
        updateUserDisplay();
    }

    // Update user display
    function updateUserDisplay() {
        if (!currentUser) return;
        
        // Update sidebar user info
        const userName = document.getElementById('userName');
        const userClass = document.getElementById('userClass');
        const userAvatar = document.getElementById('userAvatar');
        const headerAvatar = document.getElementById('headerAvatar');
        const headerPoints = document.getElementById('headerPoints');
        const profileName = document.getElementById('profileName');
        const profileClassDisplay = document.getElementById('profileClassDisplay');
        const profileSchoolDisplay = document.getElementById('profileSchoolDisplay');
        const profileAvatar = document.getElementById('profileAvatar');
        
        if (userName) userName.textContent = currentUser.name;
        if (userClass) userClass.textContent = `Class ${currentUser.class} ‚Ä¢ ${currentUser.board}`;
        if (userAvatar) userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
        if (headerAvatar) headerAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
        if (headerPoints) headerPoints.textContent = userData.points;
        if (profileName) profileName.textContent = currentUser.name;
        if (profileClassDisplay) profileClassDisplay.textContent = `Class ${currentUser.class} ‚Ä¢ ${currentUser.board}`;
        if (profileSchoolDisplay) profileSchoolDisplay.textContent = currentUser.school;
        if (profileAvatar) profileAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
        
        // Update profile form fields
        const profileFullName = document.getElementById('profileFullName');
        const profileDOB = document.getElementById('profileDOB');
        const profileGender = document.getElementById('profileGender');
        const profileCity = document.getElementById('profileCity');
        const profileEmail = document.getElementById('profileEmail');
        const profilePhone = document.getElementById('profilePhone');
        const profileClass = document.getElementById('profileClass');
        const profileBoard = document.getElementById('profileBoard');
        const profileSchool = document.getElementById('profileSchool');
        const profileRollNo = document.getElementById('profileRollNo');
        
        if (profileFullName) profileFullName.value = currentUser.name;
        if (profileDOB) profileDOB.value = currentUser.dob;
        if (profileGender) profileGender.value = currentUser.gender;
        if (profileCity) profileCity.value = currentUser.city;
        if (profileEmail) profileEmail.value = currentUser.email;
        if (profilePhone) profilePhone.value = currentUser.phone;
        if (profileClass) profileClass.value = currentUser.class;
        if (profileBoard) profileBoard.value = currentUser.board;
        if (profileSchool) profileSchool.value = currentUser.school;
        if (profileRollNo) profileRollNo.value = currentUser.rollNo;
    }

    // Refresh profile data
    function refreshProfileData() {
        console.log('üîÑ Refreshing profile data...');
        loadUserData();
        
        // Show notification
        showNotification('Profile data refreshed successfully!', 'success');
    }

    // Show notification
    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300 ${
            type === 'success' ? 'bg-green-500 text-white' : 
            type === 'error' ? 'bg-red-500 text-white' : 
            'bg-blue-500 text-white'
        }`;
        notification.innerHTML = `
            <div class="flex items-center space-x-2">
                <span class="text-lg">${type === 'success' ? '‚úÖ' : type === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
                <span>${message}</span>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        // Remove notification after 3 seconds
        setTimeout(() => {
            notification.style.opacity = '0';
            notification.style.transform = 'translateY(-100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 3000);
    }

    // Initialize other sections
    function initializeDailyQuiz() {
        console.log('üéØ Initializing Daily Quiz...');
        
        // Add event listeners
        const submitDailyAnswer = document.getElementById('submitDailyAnswer');
        const skipQuestion = document.getElementById('skipQuestion');
        
        if (submitDailyAnswer) {
            submitDailyAnswer.addEventListener('click', handleDailyAnswerSubmission);
        }
        
        if (skipQuestion) {
            skipQuestion.addEventListener('click', handleSkipQuestion);
        }
    }

    function handleDailyAnswerSubmission() {
        const selectedAnswer = document.querySelector('input[name="dailyAnswer"]:checked');
        
        if (!selectedAnswer) {
            showNotification('Please select an answer first!', 'error');
            return;
        }
        
        const answer = parseInt(selectedAnswer.value);
        const correctAnswer = 1; // New Delhi is the correct answer (index 1)
        
        const isCorrect = answer === correctAnswer;
        const pointsEarned = isCorrect ? 10 : 0;
        
        // Update user points
        if (isCorrect) {
            userData.points += pointsEarned;
            userData.quizPoints += pointsEarned;
            userData.streak += 1;
            
            // Show celebration
            showCelebration();
            showNotification(`Correct! +${pointsEarned} points earned!`, 'success');
        } else {
            userData.streak = 0;
            showNotification('Incorrect answer. Better luck next time!', 'error');
        }
        
        // Update display
        updatePointsDisplay();
        
        // Disable buttons after submission
        document.getElementById('submitDailyAnswer').disabled = true;
        document.getElementById('skipQuestion').disabled = true;
    }

    function handleSkipQuestion() {
        userData.streak = 0;
        showNotification('Question skipped. Your streak has been reset.', 'info');
        
        // Disable buttons after skipping
        document.getElementById('submitDailyAnswer').disabled = true;
        document.getElementById('skipQuestion').disabled = true;
    }

    function updatePointsDisplay() {
        const dailyStreak = document.getElementById('dailyStreak');
        const quizPoints = document.getElementById('quizPoints');
        const totalPoints = document.getElementById('totalPoints');
        const headerPoints = document.getElementById('headerPoints');
        
        if (dailyStreak) dailyStreak.textContent = userData.streak;
        if (quizPoints) quizPoints.textContent = userData.quizPoints;
        if (totalPoints) totalPoints.textContent = userData.points;
        if (headerPoints) headerPoints.textContent = userData.points;
    }

    function showCelebration() {
        // Create celebration elements
        const celebrationItems = ['üéâ', '‚≠ê', 'üéà', 'üèÜ', 'üëç'];
        
        celebrationItems.forEach((item, index) => {
            setTimeout(() => {
                const celebration = document.createElement('div');
                celebration.className = 'celebration-item';
                celebration.textContent = item;
                celebration.style.left = `${Math.random() * 80 + 10}%`;
                celebration.style.fontSize = `${Math.random() * 20 + 20}px`;
                celebration.style.animationDuration = `${Math.random() * 3 + 3}s`;
                
                document.body.appendChild(celebration);
                
                // Remove after animation completes
                setTimeout(() => {
                    if (celebration.parentNode) {
                        celebration.parentNode.removeChild(celebration);
                    }
                }, 5000);
            }, index * 300);
        });
    }

    function initializeAssessment() {
        console.log('üìã Initializing Assessment...');
        
        // Add event listeners
        const startQuickTest = document.getElementById('startQuickTest');
        const createCustomTest = document.getElementById('createCustomTest');
        
        if (startQuickTest) {
            startQuickTest.addEventListener('click', handleQuickTestStart);
        }
        
        if (createCustomTest) {
            createCustomTest.addEventListener('click', handleCustomTestCreation);
        }
    }

    function handleQuickTestStart() {
        const subject = document.getElementById('testSubject').value;
        const duration = document.getElementById('testDuration').value;
        const difficulty = document.getElementById('testDifficulty').value;
        
        if (!subject) {
            showNotification('Please select a subject first!', 'error');
            return;
        }
        
        console.log('üöÄ Starting quick test:', { subject, duration, difficulty });
        showNotification(`Starting ${subject} test (${duration} minutes, ${difficulty} difficulty)`, 'success');
        
        // Simulate test creation
        simulateTestCreation('quick');
    }

    function handleCustomTestCreation() {
        const topic = document.getElementById('customTestTopic').value.trim();
        const questions = document.getElementById('customTestQuestions').value;
        
        if (!topic) {
            showNotification('Please enter a topic for your custom test!', 'error');
            return;
        }
        
        console.log('üéØ Creating custom test:', { topic, questions });
        showNotification(`Creating custom test on "${topic}" with ${questions} questions`, 'success');
        
        // Simulate test creation
        simulateTestCreation('custom');
    }

    function simulateTestCreation(type) {
        // Show loading state
        const button = type === 'quick' ? document.getElementById('startQuickTest') : document.getElementById('createCustomTest');
        const originalText = button.textContent;
        button.textContent = type === 'quick' ? 'Generating...' : 'Creating...';
        button.disabled = true;
        
        // Simulate API call delay
        setTimeout(() => {
            // Restore button state
            button.textContent = originalText;
            button.disabled = false;
            
            // Show test popup
            showTestPopup(type);
        }, 2000);
    }

    function showTestPopup(type) {
        const popup = document.createElement('div');
        popup.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
        popup.id = 'testPopup';
        
        const testType = type === 'quick' ? 'Quick Test' : 'Custom Test';
        const testSubject = type === 'quick' ? document.getElementById('testSubject').value : document.getElementById('customTestTopic').value;
        
        popup.innerHTML = `
            <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">${testType} Created!</h2>
                <p class="text-gray-600 mb-6">Your ${testType.toLowerCase()} on <span class="font-semibold">${testSubject}</span> is ready to start.</p>
                <div class="flex space-x-4">
                    <button onclick="startTest('${type}')" class="flex-1 bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition-colors">
                        Start Test
                    </button>
                    <button onclick="closeTestPopup()" class="flex-1 bg-gray-500 text-white py-3 rounded-lg hover:bg-gray-600 transition-colors">
                        Later
                    </button>
                </div>
            </div>
        `;
        
        document.body.appendChild(popup);
    }

    function startTest(type) {
        closeTestPopup();
        showNotification('Test started! Good luck!', 'success');
        
        // Simulate test completion after a delay
        setTimeout(() => {
            // Award points
            const pointsEarned = 5 + Math.floor(Math.random() * 20);
            userData.points += pointsEarned;
            userData.testsTaken += 1;
            
            // Update display
            updatePointsDisplay();
            
            // Show results
            showNotification(`Test completed! You earned ${pointsEarned} points!`, 'success');
        }, 5000);
    }

    function closeTestPopup() {
        const popup = document.getElementById('testPopup');
        if (popup) {
            popup.remove();
        }
    }

    function initializeStudyMaterials() {
        console.log('üìö Initializing Study Materials...');
        // Additional initialization for study materials can be added here
    }

    function initializeHomework() {
        console.log('üìù Initializing Homework...');
        // Additional initialization for homework can be added here
    }

    function initializeProfile() {
        console.log('üë§ Initializing Profile...');
        
        // Add event listeners
        const saveProfileBtn = document.getElementById('saveProfileBtn');
        const resetProfileBtn = document.getElementById('resetProfileBtn');
        const addSubjectBtn = document.getElementById('addSubjectBtn');
        
        if (saveProfileBtn) {
            saveProfileBtn.addEventListener('click', saveProfile);
        }
        
        if (resetProfileBtn) {
            resetProfileBtn.addEventListener('click', resetProfile);
        }
        
        if (addSubjectBtn) {
            addSubjectBtn.addEventListener('click', addCustomSubject);
        }
    }

    function saveProfile() {
        // Get form values
        const fullName = document.getElementById('profileFullName').value;
        const dob = document.getElementById('profileDOB').value;
        const gender = document.getElementById('profileGender').value;
        const city = document.getElementById('profileCity').value;
        const studentClass = document.getElementById('profileClass').value;
        const board = document.getElementById('profileBoard').value;
        const school = document.getElementById('profileSchool').value;
        const rollNo = document.getElementById('profileRollNo').value;
        
        // Update user data
        currentUser.name = fullName;
        currentUser.dob = dob;
        currentUser.gender = gender;
        currentUser.city = city;
        currentUser.class = studentClass;
        currentUser.board = board;
        currentUser.school = school;
        currentUser.rollNo = rollNo;
        
        // Update display
        updateUserDisplay();
        
        showNotification('Profile saved successfully!', 'success');
    }

    function resetProfile() {
        if (confirm('Are you sure you want to reset your profile to default values?')) {
            // Reload user data
            loadUserData();
            showNotification('Profile reset to default values.', 'info');
        }
    }

    function addCustomSubject() {
        const newSubjectInput = document.getElementById('newSubject');
        const subjectName = newSubjectInput.value.trim();
        
        if (!subjectName) {
            showNotification('Please enter a subject name', 'error');
            return;
        }
        
        // Create new subject element
        const subjectsContainer = document.getElementById('subjectsContainer');
        if (subjectsContainer) {
            const subjectElement = document.createElement('div');
            subjectElement.className = 'flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg';
            subjectElement.innerHTML = `
                <span class="text-gray-700 font-medium">${subjectName}</span>
                <button onclick="removeSubject('${subjectName}')" class="text-red-500 hover:text-red-700 text-lg">
                    √ó
                </button>
            `;
            
            subjectsContainer.appendChild(subjectElement);
        }
        
        // Clear input
        newSubjectInput.value = '';
        
        showNotification(`Subject "${subjectName}" added successfully!`, 'success');
    }

    function removeSubject(subjectName) {
        // This would normally remove the subject from the DOM and update the backend
        showNotification(`Subject "${subjectName}" removed`, 'info');
    }

    function initializeSettings() {
        console.log('‚öôÔ∏è Initializing Settings...');
        
        // Add event listeners
        const saveSettingsBtn = document.getElementById('saveSettingsBtn');
        const resetSettingsBtn = document.getElementById('resetSettingsBtn');
        const exportDataBtn = document.getElementById('exportDataBtn');
        const resetProgressBtn = document.getElementById('resetProgressBtn');
        const deleteAccountBtn = document.getElementById('deleteAccountBtn');
        
        if (saveSettingsBtn) {
            saveSettingsBtn.addEventListener('click', saveSettings);
        }
        
        if (resetSettingsBtn) {
            resetSettingsBtn.addEventListener('click', resetSettings);
        }
        
        if (exportDataBtn) {
            exportDataBtn.addEventListener('click', exportData);
        }
        
        if (resetProgressBtn) {
            resetProgressBtn.addEventListener('click', resetProgress);
        }
        
        if (deleteAccountBtn) {
            deleteAccountBtn.addEventListener('click', deleteAccount);
        }
        
        // Teacher selection
        const teacherOptions = document.querySelectorAll('.avatar-option');
        teacherOptions.forEach(option => {
            option.addEventListener('click', function() {
                selectTeacher(this.dataset.avatar);
            });
        });
    }

    function selectTeacher(teacherId) {
        currentTeacher = teacherId;
        const teacherName = teacherId === 'roy_sir' ? 'Roy Sir' : 'Miss Sapna';
        
        // Update UI
        document.getElementById('currentTeacherName').textContent = teacherName;
        document.getElementById('avatarName').textContent = teacherName;
        
        // Update avatar selection visual
        const teacherOptions = document.querySelectorAll('.avatar-option');
        teacherOptions.forEach(option => {
            option.classList.remove('border-blue-500', 'bg-blue-50');
            option.classList.add('border-gray-200');
        });
        
        const selectedOption = document.querySelector(`[data-avatar="${teacherId}"]`);
        if (selectedOption) {
            selectedOption.classList.remove('border-gray-200');
            selectedOption.classList.add('border-blue-500', 'bg-blue-50');
        }
        
        showNotification(`Teacher changed to ${teacherName}`, 'success');
    }

    function saveSettings() {
        // This would save all settings to the backend
        showNotification('Settings saved successfully!', 'success');
    }

    function resetSettings() {
        if (confirm('Are you sure you want to reset all settings to default values?')) {
            showNotification('Settings reset to default values.', 'info');
        }
    }

    function exportData() {
        showNotification('Data export started. You will receive an email when it\'s ready.', 'info');
    }

    function resetProgress() {
        if (confirm('Are you sure you want to reset all your progress? This cannot be undone!')) {
            // Reset user data
            userData.points = 0;
            userData.streak = 0;
            userData.quizPoints = 0;
            userData.testsTaken = 0;
            userData.averageScore = 0;
            
            // Update display
            updatePointsDisplay();
            
            showNotification('All progress has been reset.', 'info');
        }
    }

    function deleteAccount() {
        if (confirm('Are you sure you want to delete your account? This cannot be undone!')) {
            showNotification('Account deletion request received. You will receive a confirmation email.', 'info');
        }
    }

    // Make functions available globally
    window.sendMessage = sendMessage;
    window.startMic = startMic;
    window.stopMic = stopMic;
    window.startCameraScan = startCameraScan;
    window.captureImage = captureImage;
    window.closeCameraModal = closeCameraModal;
    window.stopCamera = stopCamera;
    window.playTTS = playTTS;
    window.stopTTS = stopTTS;
    window.showSection = showSection;
    window.selectSubject = selectSubject;
    window.toggleSidebar = toggleSidebar;
    window.refreshProfileData = refreshProfileData;
    window.removeSubject = removeSubject;
    window.selectTeacher = selectTeacher;
    window.handleDailyAnswerSubmission = handleDailyAnswerSubmission;
    window.handleSkipQuestion = handleSkipQuestion;
    window.handleQuickTestStart = handleQuickTestStart;
    window.handleCustomTestCreation = handleCustomTestCreation;
    window.startTest = startTest;
    window.closeTestPopup = closeTestPopup;
    window.saveProfile = saveProfile;
    window.resetProfile = resetProfile;
    window.addCustomSubject = addCustomSubject;
    window.saveSettings = saveSettings;
    window.resetSettings = resetSettings;
    window.exportData = exportData;
    window.resetProgress = resetProgress;
    window.deleteAccount = deleteAccount;
</script>